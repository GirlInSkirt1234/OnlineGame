<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ —Å –∫–æ–º–Ω–∞—Ç–∞–º–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 500px;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2.2rem;
        }
        
        .screen {
            display: none;
        }
        
        .active {
            display: block;
        }
        
        .btn {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            width: 200px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, #e74c3c, #c0392b);
        }
        
        .code-display {
            background-color: #f8f9fa;
            border: 2px dashed #3498db;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            font-size: 1.8rem;
            font-weight: bold;
            letter-spacing: 5px;
            color: #2c3e50;
        }
        
        .input-field {
            width: 100%;
            padding: 12px 15px;
            margin: 15px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .input-field:focus {
            border-color: #3498db;
            outline: none;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 10px;
            margin: 20px auto;
            max-width: 300px;
        }
        
        .cell {
            aspect-ratio: 1;
            background-color: #ecf0f1;
            border: none;
            border-radius: 10px;
            font-size: 2.5rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .cell:hover {
            background-color: #d6dbdf;
            transform: scale(1.05);
        }
        
        .cell.x {
            color: #e74c3c;
        }
        
        .cell.o {
            color: #3498db;
        }
        
        .status {
            margin: 20px 0;
            font-size: 1.2rem;
            font-weight: bold;
            color: #2c3e50;
            min-height: 30px;
        }
        
        .player-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }
        
        .player {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .player.active {
            background-color: #3498db;
            color: white;
        }
        
        .player.x {
            color: #e74c3c;
        }
        
        .player.o {
            color: #3498db;
        }
        
        .message {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .instructions {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
            font-size: 0.9rem;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .game-board {
                max-width: 250px;
            }
            
            .cell {
                font-size: 2rem;
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h1>
        
        <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ -->
        <div id="menu-screen" class="screen active">
            <div class="instructions">
                <h3>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h3>
                <p>1. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º —Å –¥—Ä—É–≥–æ–º</p>
                <p>2. –ò–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç–µ—Å—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–º–Ω–∞—Ç–µ –ø–æ –∫–æ–¥—É</p>
                <p>3. –ò–≥—Ä–∞–π—Ç–µ –ø–æ –æ—á–µ—Ä–µ–¥–∏, –∑–∞–ø–æ–ª–Ω—è—è –ø–æ–ª–µ –∫—Ä–µ—Å—Ç–∏–∫–∞–º–∏ –∏ –Ω–æ–ª–∏–∫–∞–º–∏</p>
            </div>
            <button id="create-room-btn" class="btn">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
            <button id="join-room-btn" class="btn btn-secondary">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã -->
        <div id="create-room-screen" class="screen">
            <p>–í–∞—à –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã:</p>
            <div id="room-code" class="code-display">XXXX</div>
            <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —ç—Ç–∏–º –∫–æ–¥–æ–º —Å –¥—Ä—É–≥–æ–º</p>
            <div id="waiting-message" class="message">–û–∂–∏–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...</div>
            <button id="cancel-create-btn" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ -->
        <div id="join-room-screen" class="screen">
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã:</p>
            <input type="text" id="room-code-input" class="input-field" placeholder="–í–≤–µ–¥–∏—Ç–µ 4-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥" maxlength="4">
            <div id="join-error" class="message error" style="display: none;">–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã</div>
            <button id="join-btn" class="btn">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
            <button id="cancel-join-btn" class="btn btn-secondary">–ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω –∏–≥—Ä—ã -->
        <div id="game-screen" class="screen">
            <div class="player-info">
                <div class="player x" id="player-x">–ò–≥—Ä–æ–∫ X: <span id="player-x-name">–í—ã</span></div>
                <div class="player o" id="player-o">–ò–≥—Ä–æ–∫ O: <span id="player-o-name">–°–æ–ø–µ—Ä–Ω–∏–∫</span></div>
            </div>
            
            <div class="status" id="game-status">–•–æ–¥ –∏–≥—Ä–æ–∫–∞ X</div>
            
            <div class="game-board" id="game-board">
                <button class="cell" data-index="0"></button>
                <button class="cell" data-index="1"></button>
                <button class="cell" data-index="2"></button>
                <button class="cell" data-index="3"></button>
                <button class="cell" data-index="4"></button>
                <button class="cell" data-index="5"></button>
                <button class="cell" data-index="6"></button>
                <button class="cell" data-index="7"></button>
                <button class="cell" data-index="8"></button>
            </div>
            
            <button id="restart-btn" class="btn">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
            <button id="leave-room-btn" class="btn btn-secondary">–ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
        </div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const screens = {
            menu: document.getElementById('menu-screen'),
            createRoom: document.getElementById('create-room-screen'),
            joinRoom: document.getElementById('join-room-screen'),
            game: document.getElementById('game-screen')
        };
        
        const buttons = {
            createRoom: document.getElementById('create-room-btn'),
            joinRoom: document.getElementById('join-room-btn'),
            cancelCreate: document.getElementById('cancel-create-btn'),
            cancelJoin: document.getElementById('cancel-join-btn'),
            join: document.getElementById('join-btn'),
            restart: document.getElementById('restart-btn'),
            leaveRoom: document.getElementById('leave-room-btn')
        };
        
        const roomCodeDisplay = document.getElementById('room-code');
        const roomCodeInput = document.getElementById('room-code-input');
        const joinError = document.getElementById('join-error');
        const gameStatus = document.getElementById('game-status');
        const gameBoard = document.getElementById('game-board');
        const cells = document.querySelectorAll('.cell');
        const playerXName = document.getElementById('player-x-name');
        const playerOName = document.getElementById('player-o-name');
        const playerX = document.getElementById('player-x');
        const playerO = document.getElementById('player-o');
        const waitingMessage = document.getElementById('waiting-message');
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            currentPlayer: 'X',
            board: ['', '', '', '', '', '', '', '', ''],
            gameActive: false,
            roomCode: '',
            isHost: false,
            playerSymbol: 'X'
        };
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω
        function showScreen(screen) {
            Object.values(screens).forEach(s => s.classList.remove('active'));
            screen.classList.add('active');
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ–¥–∞ –∫–æ–º–Ω–∞—Ç—ã
        function generateRoomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
        buttons.createRoom.addEventListener('click', () => {
            gameState.roomCode = generateRoomCode();
            roomCodeDisplay.textContent = gameState.roomCode;
            gameState.isHost = true;
            gameState.playerSymbol = 'X';
            playerXName.textContent = '–í—ã';
            playerOName.textContent = '–û–∂–∏–¥–∞–Ω–∏–µ...';
            showScreen(screens.createRoom);
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (gameState.roomCode) {
                    startGame();
                }
            }, 3000);
        });
        
        // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∫–æ–º–Ω–∞—Ç–µ
        buttons.joinRoom.addEventListener('click', () => {
            showScreen(screens.joinRoom);
        });
        
        // –û—Ç–º–µ–Ω–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
        buttons.cancelCreate.addEventListener('click', () => {
            gameState.roomCode = '';
            showScreen(screens.menu);
        });
        
        // –û—Ç–º–µ–Ω–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
        buttons.cancelJoin.addEventListener('click', () => {
            showScreen(screens.menu);
        });
        
        // –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ –∫–æ–¥—É
        buttons.join.addEventListener('click', () => {
            const code = roomCodeInput.value.toUpperCase();
            
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–Ω–∏–º–∞–µ–º –ª—é–±–æ–π 4-—Å–∏–º–≤–æ–ª—å–Ω—ã–π –∫–æ–¥
            if (code.length === 4) {
                gameState.roomCode = code;
                gameState.isHost = false;
                gameState.playerSymbol = 'O';
                playerXName.textContent = '–•–æ—Å—Ç';
                playerOName.textContent = '–í—ã';
                startGame();
            } else {
                joinError.style.display = 'block';
            }
        });
        
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            gameState.gameActive = true;
            gameState.currentPlayer = 'X';
            gameState.board = ['', '', '', '', '', '', '', '', ''];
            
            updateGameStatus();
            updatePlayerIndicators();
            showScreen(screens.game);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä—ã
        function updateGameStatus() {
            if (gameState.gameActive) {
                gameStatus.textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞ ${gameState.currentPlayer}`;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–≥—Ä–æ–∫–æ–≤
        function updatePlayerIndicators() {
            playerX.classList.toggle('active', gameState.currentPlayer === 'X');
            playerO.classList.toggle('active', gameState.currentPlayer === 'O');
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞
        function handleCellClick(e) {
            const index = parseInt(e.target.getAttribute('data-index'));
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ö–æ–¥–∞
            if (gameState.board[index] !== '' || !gameState.gameActive) {
                return;
            }
            
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ–º —Ö–æ–¥–∏—Ç—å –ª—é–±–æ–º—É –∏–≥—Ä–æ–∫—É –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
            makeMove(index, gameState.currentPlayer);
        }
        
        // –°–æ–≤–µ—Ä—à–µ–Ω–∏–µ —Ö–æ–¥–∞
        function makeMove(index, player) {
            gameState.board[index] = player;
            cells[index].textContent = player;
            cells[index].classList.add(player.toLowerCase());
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
            if (checkWin()) {
                gameState.gameActive = false;
                gameStatus.textContent = `–ò–≥—Ä–æ–∫ ${player} –ø–æ–±–µ–¥–∏–ª!`;
                highlightWinningCells();
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—á—å–∏
            if (checkDraw()) {
                gameState.gameActive = false;
                gameStatus.textContent = '–ù–∏—á—å—è!';
                return;
            }
            
            // –°–º–µ–Ω–∞ –∏–≥—Ä–æ–∫–∞
            gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';
            updateGameStatus();
            updatePlayerIndicators();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
        function checkWin() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
                [0, 4, 8], [2, 4, 6] // –¥–∏–∞–≥–æ–Ω–∞–ª–∏
            ];
            
            return winPatterns.some(pattern => {
                const [a, b, c] = pattern;
                return gameState.board[a] !== '' && 
                       gameState.board[a] === gameState.board[b] && 
                       gameState.board[a] === gameState.board[c];
            });
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—á—å–∏
        function checkDraw() {
            return gameState.board.every(cell => cell !== '');
        }
        
        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
        function highlightWinningCells() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];
            
            const winningPattern = winPatterns.find(pattern => {
                const [a, b, c] = pattern;
                return gameState.board[a] !== '' && 
                       gameState.board[a] === gameState.board[b] && 
                       gameState.board[a] === gameState.board[c];
            });
            
            if (winningPattern) {
                winningPattern.forEach(index => {
                    cells[index].style.backgroundColor = '#2ecc71';
                    cells[index].style.color = 'white';
                });
            }
        }
        
        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        buttons.restart.addEventListener('click', () => {
            resetGame();
            startGame();
        });
        
        // –í—ã—Ö–æ–¥ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
        buttons.leaveRoom.addEventListener('click', () => {
            resetGame();
            showScreen(screens.menu);
        });
        
        // –°–±—Ä–æ—Å –∏–≥—Ä—ã
        function resetGame() {
            gameState.gameActive = false;
            gameState.board = ['', '', '', '', '', '', '', '', ''];
            gameState.currentPlayer = 'X';
            gameState.roomCode = '';
            
            cells.forEach(cell => {
                cell.textContent = '';
                cell.classList.remove('x', 'o');
                cell.style.backgroundColor = '';
                cell.style.color = '';
            });
        }
        
        // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        cells.forEach(cell => {
            cell.addEventListener('click', handleCellClick);
        });
        
        // –û—á–∏—Å—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏ –≤–≤–æ–¥–µ –∫–æ–¥–∞
        roomCodeInput.addEventListener('input', () => {
            joinError.style.display = 'none';
        });
        
        // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏
        roomCodeInput.addEventListener('input', function() {
            this.value = this.value.toUpperCase();
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∫–æ–¥–∞
        roomCodeInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                buttons.join.click();
            }
        });
    </script>
</body>
</html>